<!DOCTYPE html>
<html>
    <head>
        <title>Ohav Ben Yanai</title>
        <meta name='viewport' content='width=device-width, user-scalable=no'/>
    </head>
    <body>
        <script>

(function(){
    var definitions, Elements, sheet, myStyleSheet, propeties = [

        {
            "type": "div",
            "ID": "flexWrapper",
            "parent": "body",
            "class": "",
            "text": "",
            "html":"",
            "CSS":"width: totalWidth; height: totalHeight; position: relative; display:block; overflow:hidden;"
        }, 

        {
            "type": "div",
            "ID": "item_1",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia.</p>",
            "CSS":"background-color: yellow ;width: 30vmin; height:30vmin; overflow:hidden;"
        }, 

         {
            "type": "div",
            "ID": "item_2",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br></p>",
            "CSS":"background-color: green;;width: 40vmin; height:30vmin; overflow:hidden;"
        }, 

         {
            "type": "div",
            "ID": "item_3",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor.</p>",
            "CSS":"background-color:red ; ;width: 20vmin; height:30vmin; overflow:hidden;"
        }, 

         {
            "type": "div",
            "ID": "item_4",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>",
            "CSS":"background-color:blue ; ;width: 40vmin; height:50vmin;overflow:hidden;"
        }, 

         {
            "type": "div",
            "ID": "item_5",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor.</p>",
            "CSS":"background-color: pink; width: 50vmin; height:20vmin;overflow:hidden;"
        }, 

        {
            "type": "div",
            "ID": "item_6",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br></p>",
            "CSS":"background-color: purple;width:20vmin; height:30vmin; overflow:hidden;"
        }, 

         {
            "type": "div",
            "ID": "item_7",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor.</p>",
            "CSS":"background-color:grey; width:30vmin; height: 20vmin; overflow:hidden;"
        }, 

         {
            "type": "div",
            "ID": "item_8",
            "parent": "flexWrapper",
            "class": "items",
            "text": "",
            "html":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur et consequat elit.<br>Donec viverra eros eget ipsum semper lacinia. Sed dictum mattis arcu. <br> Proin ipsum tellus, gravida ac dui quis, venenatis venenatis dolor. <br>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>",
            "CSS":"background-color:cyan ; width:30vmin; height:40vmin; overflow:hidden;"
        }, 

        {
            "type": "class",
            "ID":"html",
            "CSS":"background: url('https://www.colehardware.com/wp-content/themes/cole/images/corkboard-background.jpg') no-repeat center center fixed; background-size: 100%; -webkit-background-size: 100%;"
        },

        {
            "type":"class",
            "ID":"body",
            "CSS":"width: totalWidth; height: totalHeight; margin: 0 auto;  overflow:hidden;"
        },

        {
            "type":"class",
            "ID":".items",
            "CSS":"font-size: 2vmin; position:absolute;"
        }
    ];

    //-------------------------------- building and setting up the domm ---------------------------------------------//


    function adjustDefs(obj, totalWidth, DivHeight, rotation){
        var defs = obj.map(function(value){
            var newText = {id:value.ID , type: value.type, css:value.CSS};
            return newText;
        });

        function NotesPosition(){
            var width = window.innerWidth, height = window.innerHeight, result;
            console.log(width/height);
                if(width/height > 1){ //landscape
                    result = [ 
                    5%,  5%, 5%,  35%,  5%, 65%, 
                    60%, 5%, 60%, 35%, 60%, 65%
                    ];
                }
                else { //portrait
                    result = [
                    5%,  5%, 5%,  60%,
                    35%, 5%, 35%, 60%,
                    65%, 5%, 65%, 60% 
                    ];
                }
            return result;
        }
        console.log(NotesPosition());
        //var DivHeight = window.innerHeight;
        //var totalWidth = window.innerWidth;
        var itemsToBeReplaced = ['totalWidth', 'totalHeight','carouselHeight', 'marginWidth', 'marginHeight', 'marginCarouselHeight'];
        var newValues = [totalWidth+'px', DivHeight+'px', Math.floor(DivHeight-130)+'px', Math.floor(totalWidth/-2)+'px',Math.floor(DivHeight/-2)+'px', Math.floor((DivHeight-130)/-2)+'px'];
        var length = defs.length;
        var itemsLength = itemsToBeReplaced.length;

        for (var s = 0 ; s < length; ++s){
            for (var r = 0; r < itemsLength; ++r){
                (function(oldValue,newValue,u){
                    defs[u].css = defs[u].css.replace(oldValue, newValue);
                }(itemsToBeReplaced[r],newValues[r],s))
            }
        }
        return defs;
    }

    function buildDoMM(data){
        var objects = data.map(function(defs){
            if (defs.type == 'class' || defs.type == 'keyframe') return;
            var Parent = document.getElementById(defs.parent);
            var Child = document.createElement(defs.type);
            if (!Parent) { Parent = document.getElementsByTagName('body')[0];}
            if (defs.class && defs.class !=='') { Child.classList.add(defs.class); }
            if (defs.html) {Child.innerHTML = defs.html;}
            Child.id = defs.ID;
            Parent.appendChild(Child);
            return Child;
        });
        resize();
        return objects;
    }

    function setStyleSheet(object){
        myStyleSheet = document.createElement('style');
        myStyleSheet.appendChild(document.createTextNode('')); // this is for webkit
        document.head.appendChild(myStyleSheet);
        var length = object.length, i;
        for (i = 0; i< length; ++i){
            (function(target){
                if (target.type == 'div' || target.type == 'canvas'){
                    return myStyleSheet.sheet.insertRule( '#' + target.id + ' {' + target.css + '}' , 0 );
                }
                else if(target.type == 'class'){
                    try {
                        myStyleSheet.sheet.insertRule( target.id + ' {' + target.css + '}' , 0 );
                    }
                    catch(err) {
                        console.log(err)
                    }
                    return
                }
                else if(target.type == 'keyframe'){
                    return myStyleSheet.sheet.insertRule( '@' + myPrefix + 'keyframes ' + target.id + '{'+ target.css + '}', 0 );
                }
                else return console.log(target.id + 'is not valid target for CSS rules')
            }(object[i]));
        }
        console.log(myStyleSheet.sheet)
        return myStyleSheet.sheet;
    }

    

    var sizeCanvas = function(){
        //console.log('resizing canvas')
        canvas = document.getElementsByTagName('canvas');
        for (a = 0; a < canvas.length; a++){
            (function(a){
                var parent = canvas[a].parentNode;
                canvas[a].width = parent.clientWidth;
                canvas[a].height = parent.clientHeight;
            }(a));
        };
    };

    function resize(){
        var width = window.outerWidth;
        var height = window.outerHeight;
        var orientation = width/height;
        var styleSheet = document.getElementsByTagName('style')[0];
        if (styleSheet) styleSheet.parentNode.removeChild(styleSheet);
        if (orientation < 1 ) return new setStyleSheet(adjustDefs(propeties, width, height, 0));
        else if (orientation > 1 ) return new setStyleSheet(adjustDefs(propeties, width, height, 0));
        return
    };


    //------- debounce and throttle functions courtsey of David Walsh https://davidwalsh.name/javascript-debounce-function ------//
    function debounce(func, wait, immediate) {
        var timeout;
        return function() {
            var context = this, args = arguments;
            var later = function() {
                timeout = null;
                if (!immediate) func.apply(context, args);
            };
            var callNow = immediate && !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) func.apply(context, args);
        };
    };

    function throttle(delay, callback) {
        var previousCall = new Date().getTime();
        return function() {
            var time = new Date().getTime();
            if ((time - previousCall) >= delay) {
                previousCall = time;
                callback.apply(null, arguments);
            }
        };
    };

    function prefix() { // courtosy of David Walch https://davidwalsh.name/vendor-prefix
        var styles = window.getComputedStyle(document.documentElement, ''),
        pre = (Array.prototype.slice
        .call(styles)
        .join('')
        .match(/-(moz|webkit|ms)-/) || (styles.OLink === '' && ['', 'o']))[1],
        dom = ('WebKit|Moz|MS|O').match(new RegExp('(' + pre + ')', 'i'))[1];
        return {
            dom: dom,
            lowercase: pre,
            css: '-' + pre + '-',
            js: pre[0].toUpperCase() + pre.substr(1)
        }
    };

    window.onload = function(){
        console.log('loaded')
        Elements = new buildDoMM(propeties);
        //sizeCanvas(); //uncomment this line if you have canvas elements
        window.addEventListener('resize', debounce(resize, 50), false);
    };
}()); // end of main scope
        </script>
    </body>
</html>